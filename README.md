# Maximum-Entropy-Model-and-Expectation-maximization-algorithm
Maximum Entropy Model and Expectation-maximization algorithmï¼Œæœ€å¤§ç†µæ¨¡å‹ä¸EMç®—æ³•ã€‚

## é˜…è¯»æŒ‡å—

1. åœ¨çº¿è§‚çœ‹è¯·ä½¿ç”¨Chromeæµè§ˆå™¨ï¼Œå¹¶å®‰è£…æ’ä»¶ï¼š[MathJax Plugin for Github(éœ€ç§‘å­¦ä¸Šç½‘)](https://chrome.google.com/webstore/detail/mathjax-plugin-for-github/ioemnmodlmafdkllaclgeombjnmnbima)ï¼Œ æ’ä»¶[Githubåœ°å€](https://github.com/orsharir/github-mathjax)
2. æˆ–ä¸‹è½½å†…å®¹åˆ°æœ¬åœ°ï¼Œä½¿ç”¨markdownç›¸å…³è½¯ä»¶æ‰“å¼€ï¼Œå¦‚ï¼š[Typora](https://typora.io/)
3. **è‹¥æ•°å­¦å…¬å¼æ˜¾ç¤ºå‡ºç°é—®é¢˜å¤§å®¶ä¹Ÿå¯é€šè¿‡jupyter notebooké“¾æ¥æŸ¥çœ‹ï¼š[Maximum-Entropy-Model-and-Expectation-maximization-algorithm](https://nbviewer.jupyter.org/github/Knowledge-Precipitation-Tribe/Maximum-Entropy-Model-and-Expectation-maximization-algorithm/blob/master/jupyter%20notebook/Maximum-Entropy-Model-and-Expectation-maximization-algorithm.ipynb)**

## Content

- <a href = "#ç†µç­‰ç›¸å…³æ¦‚å¿µ">ç†µç­‰ç›¸å…³æ¦‚å¿µ</a>
  - <a href = "#ä¿¡æ¯é‡">ä¿¡æ¯é‡</a>
  - <a href = "#ç†µ">ç†µ</a>
    - <a href = "#è”åˆç†µ">è”åˆç†µ</a>
    - <a href = "#æ¡ä»¶ç†µ">æ¡ä»¶ç†µ</a>
    - <a href = "#äº’ä¿¡æ¯">äº’ä¿¡æ¯</a>
  - <a href = "#ç›¸å¯¹ç†µ">ç›¸å¯¹ç†µ</a>
  - <a href = "#äº¤å‰ç†µ">äº¤å‰ç†µ</a>
- <a href = "#æœ€å¤§ç†µæ¨¡å‹">æœ€å¤§ç†µæ¨¡å‹</a>
- <a href = "#Jensenä¸ç­‰å¼">Jensenä¸ç­‰å¼</a>
- <a href = "#æå¤§ä¼¼ç„¶ä¼°è®¡">æå¤§ä¼¼ç„¶ä¼°è®¡</a>
- <a href = "#æå¤§ä¼¼ç„¶ä¼°è®¡ä¸EMç®—æ³•çš„é€‚ç”¨é—®é¢˜">æå¤§ä¼¼ç„¶ä¼°è®¡ä¸EMç®—æ³•çš„é€‚ç”¨é—®é¢˜</a>
- <a href = "#EMç®—æ³•">EMç®—æ³•</a>
  - <a href = "#ä»€ä¹ˆæ˜¯EMç®—æ³•">ä»€ä¹ˆæ˜¯EMç®—æ³•</a>
  - <a href = "#EMç®—æ³•çš„é€šä¿—è§£é‡Š">EMç®—æ³•çš„é€šä¿—è§£é‡Š</a>
    - <a href = "#ä¾‹å­1">ä¾‹å­1</a>
    - <a href = "#ä¾‹å­2">ä¾‹å­2</a>
  - <a href = "#æ•°å­¦æ¨å¯¼">æ•°å­¦æ¨å¯¼</a>
  - <a href = "#EMç®—æ³•æµç¨‹">EMç®—æ³•æµç¨‹</a>
  - <a href = "#ä»£ç å®ç°">ä»£ç å®ç°</a>
    - <a href = "#äºŒç»´é«˜æ–¯åˆ†å¸ƒ">äºŒç»´é«˜æ–¯åˆ†å¸ƒ</a>
    - <a href = "#æ•°æ®å¯è§†åŒ–">æ•°æ®å¯è§†åŒ–</a>
    - <a href = "#å˜é‡åˆå§‹åŒ–">å˜é‡åˆå§‹åŒ–</a>
    - <a href = "#Eæ­¥éª¤">Eæ­¥éª¤</a>
    - <a href = "#Mæ­¥éª¤">Mæ­¥éª¤</a>
    - <a href = "#è¿­ä»£æ±‚è§£">è¿­ä»£æ±‚è§£</a>
    - <a href = "#å®Œæ•´ä»£ç ">å®Œæ•´ä»£ç </a>
- <a href = "#å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</a>

# [ç†µç­‰ç›¸å…³æ¦‚å¿µ](#content)

## [ä¿¡æ¯é‡](#content)

ä¿¡æ¯çš„åº¦é‡ï¼Œä¸€ä¸ªæ˜¯å‘ç”Ÿçš„æ¦‚ç‡è¶Šé«˜ï¼Œé‚£ä¹ˆå®ƒçš„ä¿¡æ¯é‡å°±è¶Šä½ã€‚

## [ç†µ](#content)

ç†µæ˜¯ä¿¡æ¯é‡çš„æœŸæœ›ï¼ˆç”¨ä¸€ä¸ªå¤§çƒæ¥è¡¨ç¤ºï¼Œï¼‰

åæ˜ çš„æ˜¯ä¸ç¡®å®šæ€§ï¼Œå˜é‡å‘ç”Ÿçš„æ¦‚ç‡è¶Šä½ï¼Œä¸ç¡®å®šæ€§è¶Šé«˜ï¼Œç†µè¶Šé«˜ã€‚

### [è”åˆç†µ](#content)

ç”¨éŸ¦æ©å›¾è¡¨ç¤ºï¼Œå°±æ˜¯ä¸¤ä¸ªåœ†ç›¸äº¤çš„æ€»ä½“é¢ç§¯

è”åˆç†µå…¬å¼
$$
H(x, y)=-\sum_{i=1}^{n} \sum_{j=1}^{n} f\left(x_{i}, y_{j}\right) \log _{2} p\left(x_{i}, y_{j}\right)
$$
è¿™å°±æ˜¯

### [æ¡ä»¶ç†µ](#content)

ç”¨éŸ¦æ©å›¾è¡¨ç¤ºï¼Œå°±æ˜¯å¤§åœ†å‡å»äº¤é›†éƒ¨åˆ†

### [äº’ä¿¡æ¯](#content)

ç”¨éŸ¦æ©å›¾è¡¨ç¤ºå°±æ˜¯ä¸¤ä¸ªåœ†çš„äº¤é›†ï¼Œ

ç”¨äºç‰¹å¾é€‰æ‹©æˆ–ç‰¹å¾é—´çš„å…³è”æ€§ï¼Œç„¶ååšé™ç»´å¤„ç†

## [ç›¸å¯¹ç†µ](#content)

ç›¸å¯¹ç†µæœ‰åKLæ•£åº¦ï¼Œåˆ»ç”»çš„äº‹ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ï¼ˆKLæ•£åº¦ï¼ŒWaseï¼Œ MMDï¼‰ã€‚

## [äº¤å‰ç†µ](#content)



# [æœ€å¤§ç†µæ¨¡å‹](#content)



# [Jensenä¸ç­‰å¼](#content)



# [æå¤§ä¼¼ç„¶ä¼°è®¡](#content)



# [æå¤§ä¼¼ç„¶ä¼°è®¡ä¸EMç®—æ³•çš„é€‚ç”¨é—®é¢˜](#content)

å‚è€ƒè‡ªè¯¦è§£EMç®—æ³•ä¸æ··åˆé«˜æ–¯æ¨¡å‹$^{[6]}$ã€‚

**æå¤§ä¼¼ç„¶ä¼°è®¡ï¼š**

é€‚ç”¨äºæŸç»„æ•°æ®æœä»æŸä¸€åˆ†å¸ƒï¼Œæˆ‘ä»¬ç°åœ¨å¾—åˆ°äº†è¿™ç»„æ•°æ®ä¸­çš„é‡‡æ ·å€¼ï¼Œç°åœ¨æˆ‘ä»¬æƒ³æ±‚è§£è¿™ä¸€åˆ†å¸ƒçš„å‚æ•°æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æå¤§ä¼¼ç„¶çš„æ–¹æ³•è¿›è¡Œæ±‚è§£ã€‚å°±åƒä¹‹å‰ä»‹ç»åˆ°çš„ï¼Œåœ¨æå¤§ä¼¼ç„¶ä¼°è®¡ä¸­æˆ‘ä»¬æ˜¯å¯¹ä¼¼ç„¶å‡½æ•°æ±‚åå¯¼ï¼Œä»¤å…¶å¾—0ï¼Œç„¶åå¾—åˆ°æ¨¡å‹çš„å‚æ•°ï¼Œä½†æ˜¯å¦‚æœæ•°æ®æ˜¯æ¥è‡ªå¤šä¸ªåˆ†å¸ƒï¼Œå°±æ²¡åŠæ³•é€šè¿‡æ±‚å¯¼å¾—0çš„æ–¹æ³•æ¥å¾—åˆ°å‚æ•°çš„ä¼°è®¡å€¼äº†ï¼Œè¿™æ—¶å°±è¦ç”¨åˆ°EMç®—æ³•ã€‚

**EMç®—æ³•ï¼š**

é€‚ç”¨äºæŸç»„æ•°æ®æœä»ä¸€ä¸ªæ··åˆçš„åˆ†å¸ƒ(å¦‚æœè¿™å‡ ä¸ªåˆ†å¸ƒéƒ½æ˜¯é«˜æ–¯åˆ†å¸ƒçš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå°±å«åšé«˜æ–¯æ··åˆæ¨¡å‹)ã€‚ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†è¿™ä¸€æ··åˆåˆ†å¸ƒä¸­çš„ä¸€äº›é‡‡æ ·æ•°æ®ï¼Œåæ¨è¿™äº›é‡‡æ ·æ•°æ®åˆ†åˆ«æ˜¯å±äºå“ªä¸€ç±»çš„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥é‡‡ç”¨EMç®—æ³•è¿›è¡Œæ±‚è§£ã€‚

![em-mle](img/em-mle.png)

# [EMç®—æ³•](#content)

## [ä»€ä¹ˆæ˜¯EMç®—æ³•](#content)

EMç®—æ³•è¢«ç§°ä¸ºæ•°æ®æŒ–æ˜çš„åå¤§ç®—æ³•ä¹‹ä¸€ï¼Œåœ¨æœºå™¨å­¦ä¹ å’Œæ•°æ®æŒ–æ˜é¢†åŸŸå æœ‰å¾ˆé‡è¦çš„åœ°ä½ã€‚æ¥ä¸‹æ¥æˆ‘å°±ç”¨å°½é‡é€šä¿—çš„è¯­è¨€æ¥æ¢³ç†ä¸€ä¸‹EMç®—æ³•ã€‚EMç®—æ³•ä¹Ÿç§°ä¸ºæœŸæœ›æœ€å¤§åŒ–(Expectation-Maximum)ç®—æ³•ï¼Œåœ¨å¾ˆå¤šåœ°æ–¹éƒ½èƒ½çœ‹åˆ°ä»–çš„èº«å½±ï¼Œä¾‹å¦‚HMMä»¥åŠLDAç­‰ã€‚

> ç»´åŸºç™¾ç§‘å®šä¹‰ï¼š
>
> **æœ€å¤§æœŸæœ›ç®—æ³•**ï¼ˆ**Expectation-maximization algorithm**ï¼Œåˆè¯‘**æœŸæœ›æœ€å¤§åŒ–ç®—æ³•**ï¼‰åœ¨ç»Ÿè®¡ä¸­è¢«ç”¨äºå¯»æ‰¾ï¼Œä¾èµ–äºä¸å¯è§‚å¯Ÿçš„éšæ€§å˜é‡çš„æ¦‚ç‡æ¨¡å‹ä¸­ï¼Œå‚æ•°çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚
>
> åœ¨[ç»Ÿè®¡](https://zh.wikipedia.org/wiki/ç»Ÿè®¡)[è®¡ç®—](https://zh.wikipedia.org/wiki/è®¡ç®—)ä¸­ï¼Œ**æœ€å¤§æœŸæœ›ï¼ˆEMï¼‰ç®—æ³•**æ˜¯åœ¨[æ¦‚ç‡æ¨¡å‹](https://zh.wikipedia.org/wiki/æ¦‚ç‡æ¨¡å‹)ä¸­å¯»æ‰¾[å‚æ•°](https://zh.wikipedia.org/wiki/å‚æ•°)[æœ€å¤§ä¼¼ç„¶ä¼°è®¡](https://zh.wikipedia.org/wiki/æœ€å¤§ä¼¼ç„¶ä¼°è®¡)æˆ–è€…[æœ€å¤§åéªŒä¼°è®¡](https://zh.wikipedia.org/wiki/æœ€å¤§åéªŒæ¦‚ç‡)çš„[ç®—æ³•](https://zh.wikipedia.org/wiki/ç®—æ³•)ï¼Œå…¶ä¸­æ¦‚ç‡æ¨¡å‹ä¾èµ–äºæ— æ³•è§‚æµ‹çš„[éšå˜é‡](https://zh.wikipedia.org/wiki/éšå˜é‡)ã€‚æœ€å¤§æœŸæœ›ç®—æ³•ç»å¸¸ç”¨åœ¨[æœºå™¨å­¦ä¹ ](https://zh.wikipedia.org/wiki/æœºå™¨å­¦ä¹ )å’Œ[è®¡ç®—æœºè§†è§‰](https://zh.wikipedia.org/wiki/è®¡ç®—æœºè§†è§‰)çš„[æ•°æ®èšç±»](https://zh.wikipedia.org/wiki/æ•°æ®èšç±»)ï¼ˆData Clusteringï¼‰é¢†åŸŸã€‚æœ€å¤§æœŸæœ›ç®—æ³•ç»è¿‡ä¸¤ä¸ªæ­¥éª¤äº¤æ›¿è¿›è¡Œè®¡ç®—ï¼Œç¬¬ä¸€æ­¥æ˜¯è®¡ç®—æœŸæœ›ï¼ˆEï¼‰ï¼Œåˆ©ç”¨å¯¹éšè—å˜é‡çš„ç°æœ‰ä¼°è®¡å€¼ï¼Œè®¡ç®—å…¶æœ€å¤§ä¼¼ç„¶ä¼°è®¡å€¼ï¼›ç¬¬äºŒæ­¥æ˜¯æœ€å¤§åŒ–ï¼ˆMï¼‰ï¼Œæœ€å¤§åŒ–åœ¨Eæ­¥ä¸Šæ±‚å¾—çš„[æœ€å¤§ä¼¼ç„¶å€¼](https://zh.wikipedia.org/wiki/æœ€å¤§ä¼¼ç„¶ä¼°è®¡)æ¥è®¡ç®—å‚æ•°çš„å€¼ã€‚Mæ­¥ä¸Šæ‰¾åˆ°çš„å‚æ•°ä¼°è®¡å€¼è¢«ç”¨äºä¸‹ä¸€ä¸ªEæ­¥è®¡ç®—ä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸æ–­äº¤æ›¿è¿›è¡Œã€‚

çœ‹å®Œæ˜¯ä¸æ˜¯æœ‰ç§é»‘äººé—®å·è„¸çš„æ„Ÿè§‰ã€‚

![heirenwenhao](img/heirenwenhao.jpg)

ä½†æ˜¯ä¸è¦æ…Œï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±æ¥æ¢³ç†ä¸€ä¸‹è¿™ä¸ªEMç®—æ³•ã€‚

## [EMç®—æ³•é€šä¿—è§£é‡Š](#content)

åœ¨ä¸€äº›èµ„æ–™ä¸­é¦–å…ˆä¼šä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯ä¼¼ç„¶å‡½æ•°ï¼Œä»€ä¹ˆæ˜¯æå¤§ä¼¼ç„¶ä¼°è®¡ç­‰ç­‰ï¼Œæˆ‘ä»¬è¿™é‡Œå…ˆè¯•ç€æŠ›å¼€è¿™äº›ä¸œè¥¿ä¸è°ˆï¼Œç›´æ¥æ¥ç†è§£ä¸€ä¸‹EMç®—æ³•ã€‚

**EMç®—æ³•ç”¨æœ€ç®€å•çš„è¯æ¥è¯´å°±æ˜¯ï¼šç»™ä½ ä¸€å †æ•°æ®ï¼Œç„¶åå‘Šè¯‰ä½ è¿™äº›æ•°æ®æ˜¯æ»¡è¶³ä¸€ä¸ªåˆ†å¸ƒçš„ï¼Œç°åœ¨ä½ å°±æ¥æ¨å¯¼ä¸€ä¸‹å‚æ•°æ˜¯ä»€ä¹ˆæ ·çš„åˆ†å¸ƒå¯ä»¥æ‹Ÿåˆè¿™å †æ•°æ®ã€‚**

å¦‚æœä½ äº†è§£è¿‡å‚æ•°ä¼°è®¡ï¼Œé‚£ä½ å¯èƒ½ä¼šæœ‰ä¸€ç‚¹å¤´ç»ªï¼Œå°±ç®—æ²¡æœ‰å¤´ç»ªä¹Ÿæ²¡å…³ç³»ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚

### [ä¾‹å­1](#content)

ä¾‹å­å¯èƒ½å¹¶ä¸é‚£ä¹ˆä¸¥è°¨ï¼Œæ¬¢è¿æ‰¹è¯„æŒ‡æ­£ã€‚

ç°åœ¨æˆ‘ä»¬æœ‰4ä½å¿—æ„¿è€…ï¼Œæˆ‘ä»¬é€šè¿‡æµ‹é‡è·å¾—äº†ä»–ä»¬çš„èº«é«˜æ•°æ®ã€‚ä½†æ˜¯è¿™äº›å¿—æ„¿è€…å½“ä¸­æœ‰ç”·æ€§æœ‰å¥³æ€§ï¼Œå…·ä½“æ¯”ä¾‹æˆ‘ä»¬æ²¡æœ‰è®°å½•ï¼Œæ‰€ä»¥ä¸çŸ¥é“ç”·å¥³å„æœ‰å¤šå°‘ï¼Œå‡è®¾ç”·å¥³å„å çš„æ¯”ä¾‹åˆ†åˆ«ç”¨$\pi_{ç”·},\pi_{å¥³}$è¡¨ç¤ºã€‚å‡è®¾ç”·æ€§å’Œå¥³æ€§çš„èº«é«˜åˆ†åˆ«æœä»$\mathrm{N}\left(\mu_{ç”·}, \sigma_{ç”·}^{2}\right)$å’Œ$\mathrm{N}\left(\mu_{å¥³}, \sigma_{å¥³}^{2}\right)$çš„é«˜æ–¯åˆ†å¸ƒï¼Œç°åœ¨æˆ‘ä»¬æ¥ä¼°è®¡ä¸€ä¸‹è¿™å…­ä¸ªå‚æ•°$\mu_{ç”·}, \sigma_{ç”·} ^ {2},\mu_{å¥³}, \sigma_{å¥³} ^ {2},\pi_{ç”·},\pi_{å¥³}$å¯èƒ½çš„å€¼æ˜¯å¤šå°‘ã€‚

è§£ï¼š

åæ­£ç°åœ¨æ˜¯è®©æˆ‘ä»¬ä¼°è®¡è¿™å‡ ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬ä¸å¦¨ççŒœä¸€ä¸‹ï¼Œå°±å‡è®¾$\mu_{ç”·}=170, \sigma_{ç”·} ^ 2=36,\mu_{å¥³}=160, \sigma_{å¥³} ^ 2=25$ï¼Œè€Œä¸”ç”·å¥³å„ä¸€åŠæˆ‘ä»¬ç”¨$\pi_{ç”·}=\pi_{å¥³}=0.5$è¡¨ç¤ºã€‚

è€Œä¸”å·²çŸ¥å…¶æ˜¯æ»¡è¶³é«˜æ–¯åˆ†å¸ƒçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°é«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼š
$$
f(x)=\frac{1}{\sigma \sqrt{2 \pi}} e^{-\frac{(x-\mu)^{2}}{2 \sigma^{2}}}
$$
ç°åœ¨æˆ‘ä»¬æ‹¿åˆ°ç¬¬ä¸€ä¸ªå¿—æ„¿è€…çš„èº«é«˜æ•°æ®ï¼š$x_1=188$ï¼Œæˆ‘ä»¬ç°åœ¨æ¥åˆ¤æ–­ä¸€ä¸‹ç¬¬ä¸€ä¸ªå¿—æ„¿è€…å±äºç”·æ€§çš„æ¦‚ç‡æœ‰å¤šå¤§ã€‚æˆ‘ä»¬ç°åœ¨å°†188ä»£å…¥åˆ°æ¦‚ç‡å¯†åº¦å‡½æ•°å½“ä¸­
$$
\begin{aligned}
f(188 | \mu_{ç”·}, \sigma_{ç”·}^{2}) &=\frac{1}{6 \times \sqrt{2 \pi}} e^{-\frac{(188-170)^{2}}{2 \times 6 ^ 2}} \\
&= 7.368 \times 10^{-4} \\
f(188 | \mu_{å¥³}, \sigma_{å¥³}^{2}) &=\frac{1}{5 \times \sqrt{2 \pi}} e^{-\frac{(188-160)^{2}}{2 \times 5 ^{2}}} \\
&= 1.236 \times 10^{-8}
\end{aligned}
$$
è€Œä¸”æˆ‘ä»¬å‡è®¾$\pi_{ç”·}=\pi_{å¥³}=0.5$ï¼Œé‚£ä¹ˆå½“å‰ç¬¬ä¸€ä¸ªå¿—æ„¿è€…ä¸ºç”·æ€§çš„æ¦‚ç‡
$$
\frac{7.368 \times 10^{-4} \times 0.5}{7.368 \times 10^{-4} \times 0.5+1.236 \times 10^{-8} \times 0.5}=0.999
$$
ä¸ºå¥³æ€§çš„æ¦‚ç‡
$$
\frac{1.236 \times 10^{-8} \times 0.5}{7.368 \times 10^{-4} \times 0.5+1.236 \times 10^{-8} \times 0.5}=0.001
$$
çœ‹æ¥æˆ‘ä»¬çŒœçš„è¿˜å¯ä»¥ï¼Œ188å±äºç”·æ€§çš„æ¦‚ç‡ç¡®å®å¾ˆé«˜ã€‚Anywayï¼Œæˆ‘ä»¬ç»§ç»­æ¥ç®—ä¸€ä¸‹å‰©ä¸‹çš„ä¸‰ä¸ªå¿—æ„¿è€…çš„æ•°æ®ï¼Œä¸ç¬¬ä¸€ä¸ªå¿—æ„¿çš„ç®—æ³•ç±»ä¼¼ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚

å‰©ä¸‹çš„ä¸‰ä¸ªå¿—æ„¿è€…çš„èº«é«˜æ•°æ®åˆ†åˆ«ä¸ºï¼š$x_2=158, x_3=165, x_4=170$ã€‚é‚£æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°è¿™æ ·ä¸€ç»„æ•°æ®ã€‚
$$
x_{1} = 188 = \left\{\begin{array}{ll}
0.999, \text {ç”·} \\
0.001, \text {å¥³}
\end{array}\right. ,
x_{2}= 158 = \left\{\begin{array}{ll}
0.098, \text {ç”·} \\
0.901, \text {å¥³}
\end{array}\right. ,
x_{3} = 165 = \left\{\begin{array}{ll}
0.490, \text {ç”·} \\
0.510, \text {å¥³}
\end{array}\right. ,
x_{4} = 170 = \left\{\begin{array}{ll}
0.529, \text {ç”·} \\
0.471, \text {å¥³}
\end{array}\right.
$$
ä¹‹åæˆ‘ä»¬å†å°†æ¯ä¸€ç»„æ•°æ®ä¸­çš„ç”·å¥³æ±‡æ€»ä¸€ä¸‹ï¼Œå¾—åˆ°è¿™æ ·ä¸€ç»„æ•°æ®
$$
x_{1} = \left\{\begin{array}{ll}
188 \times 0.999 = 187.812, \text {ç”·} \\
188 \times 0.001 = 0.188, \text {å¥³}
\end{array}\right. ,
x_{2} = \left\{\begin{array}{ll}
158 \times 0.098 = 15.484, \text {ç”·} \\
158 \times 0.901 = 142.358, \text {å¥³}
\end{array}\right. \\
x_{3}  = \left\{\begin{array}{ll}
165 \times 0.490 = 80.85, \text {ç”·} \\
165 \times 0.510 = 84.51, \text {å¥³}
\end{array}\right. ,
x_{4} = \left\{\begin{array}{ll}
170 \times 0.52 = 88.4, \text {ç”·} \\
170 \times 0.47 = 79.9, \text {å¥³}
\end{array}\right.
$$
è¿™æ ·çš„åˆ°çš„å››ç»„æ•°æ®ä¸­ç”·å’Œå¥³å°±æ›´ç¬¦åˆç°å®çš„æƒ…å†µï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»æŠŠçœŸå®çš„æ•°æ®æºè¿›å»åšäº†ä¸€éè®¡ç®—ï¼Œé‚£ä¹ˆç°åœ¨ç”¨è¿™å››ç»„æ•°æ®ä¸­çš„ç”·å’Œå¥³æ¥è°ƒæ•´ä¸€ä¸‹æœ€å¼€å§‹ä¼°è®¡çš„é‚£å…­ä¸ªå‚æ•°$\mu_{ç”·}, \sigma_{ç”·} ^ 2,\mu_{å¥³}, \sigma_{å¥³} ^ 2,\pi_{ç”·},\pi_{å¥³}$ã€‚

å…¶ä¸­$\pi_{ç”·},\pi_{å¥³}$çš„è°ƒæ•´æ–¹å¼å°±æ˜¯å°†å››ç»„æ•°æ®ä¸­ç”·ï¼Œå¥³çš„å¯èƒ½æ€§ç›¸åŠ å¤„ä»¥4å¾—åˆ°çš„ï¼š
$$
\pi_{ç”·} = \frac{0.999 + 0.098 + 0.490 + 0.529}{4} = 0.529 \\
\pi_{å¥³} = \frac{0.001 + 0.901 + 0.510 + 0.471}{4} = 0.470
$$
æˆ‘ä»¬å†æ¥è°ƒæ•´ä¸€ä¸‹$\mu_{ç”·}, \sigma_{ç”·}$ï¼Œè¿™ä¸¤ä¸ªå‚æ•°æ€ä¹ˆè°ƒæ•´å‘¢ï¼Œè¿™é‡Œç›´æ¥å‘Šè¯‰ä½ ä¸€ä¸ªç»“è®ºï¼Œå…ˆä¸ç”¨ç®¡ä»–æ˜¯æ€ä¹ˆæ¥çš„ï¼Œæˆ‘ä»¬ä¼šç”¨å°±okäº†ã€‚å¦‚æœæœ‰ä¸€ç»„æ•°æ®$x_1, x_2, x_3, x_4$ç¬¦åˆé«˜æ–¯$\mathrm{N}\left(\mu, \sigma\right)$åˆ†å¸ƒï¼Œé‚£ä¹ˆä»–ä»¬çš„å‚æ•°çš„ä¼°è®¡å€¼ä¸ºï¼š
$$
\begin{aligned}
&\mu=\frac{1}{n} \sum_{i} x_{i}\\
&\sigma^{2}=\frac{1}{n} \sum_{i}\left(x_{i}-\mu\right)^{2}
\end{aligned}
$$
æ ¹æ®è¿™ä¸ªç»“è®ºæˆ‘ä»¬æ‹¿å¾—åˆ°çš„å››ç»„æ•°æ®æ›´æ–°ä¸€ä¸‹å¯¹åº”çš„$\mu_{ç”·}, \sigma_{ç”·} ^ 2$ã€‚
$$
\mu_{ç”·} = \frac{181.812+15.484+80.85+88.4}{0.999+0.098+0.490+0.529}=173.225 \\
\sigma_{ç”·} ^ 2 = \frac{(187.812-173.225)^{2}+(15.484-173.225)^{2}+(80.85-173.225)^{2}+(88.4-173.225)^{2}}{0.999+0.098+0.490+0.529}=19292.733
$$
æ ¹æ®ç›¸åŒçš„åŸåˆ™ï¼Œæˆ‘ä»¬å†æ¥æ›´æ–°ä¸€ä¸‹å¯¹åº”çš„$\mu_{å¥³}, \sigma_{å¥³} ^ 2$ã€‚
$$
\mu_{å¥³} = \frac{0.188+142.358+84.51+79.9}{0.001+0.901+0.510+0.471}=163.014 \\
\sigma_{å¥³} ^ 2 = \frac{(0.188-163.014)^{2}+(142.358-163.014)^{2}+(84.51-163.014)^{2}+(79.9-163.014)^{2}}{0,001+0,901+0.510+0.471}=21247.897
$$
ç„¶åæˆ‘ä»¬æ ¹æ®æ›´æ–°åçš„å‚æ•°å†æ¬¡ä»å¤´è®¡ç®—ä¸€ä¸‹ï¼Œå› ä¸ºæ¯æ¬¡è®¡ç®—éƒ½ç›¸å½“äºå°†æ•°æ®çš„çœŸå®æƒ…å†µæºæ‚çš„å‚æ•°ä¸­ï¼Œæ‰€ä»¥æœ€ç»ˆå°±èƒ½æ”¶æ•›åˆ°ç¬¦åˆæ•°æ®åˆ†å¸ƒçš„çœŸå®æƒ…å†µã€‚

å…¶å®è¿™ä¸ªä¾‹å­è¿˜æœ‰å¦å¤–ä¸€ä¸ªåç§°å°±æ˜¯é«˜æ–¯æ··åˆæ¨¡å‹GMMã€‚

### [ä¾‹å­2](#content)

è¿™é‡Œè´´ä¸€ä¸‹July$^{[5]}$çš„ç¡¬å¸æ¡ˆä¾‹ï¼š

ä¸¤æšç¡¬å¸Aå’ŒBï¼Œå‡å®šéšæœºæŠ›æ·åæ­£é¢æœä¸Šæ¦‚ç‡åˆ†åˆ«ä¸º$P_A$ï¼Œ$P_B$ã€‚ä¸ºäº†ä¼°è®¡è¿™ä¸¤ä¸ªç¡¬å¸æœä¸Šçš„æ¦‚ç‡ï¼Œå’±ä»¬è½®æµæŠ›ç¡¬å¸Aå’ŒBï¼Œæ¯ä¸€è½®éƒ½è¿ç»­æŠ›5æ¬¡ï¼Œæ€»å…±5è½®ï¼š

| ç¡¬å¸ | ç»“æœ       | ç»Ÿè®¡    |
| :--- | ---------- | ------- |
| A    | æ­£æ­£åæ­£å | 3æ­£-2å |
| B    | ååæ­£æ­£å | 2æ­£-3å |
| A    | æ­£åååå | 1æ­£-4å |
| B    | æ­£ååæ­£æ­£ | 3æ­£-2å |
| A    | åæ­£æ­£åå | 2æ­£-3å |

ç¡¬å¸Aè¢«æŠ›äº†15æ¬¡ï¼Œåœ¨ç¬¬ä¸€è½®ã€ç¬¬ä¸‰è½®ã€ç¬¬äº”è½®åˆ†åˆ«å‡ºç°äº†3æ¬¡æ­£ã€1æ¬¡æ­£ã€2æ¬¡æ­£ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“ä¼°è®¡å‡º$P_A$ï¼Œç±»ä¼¼çš„ï¼Œ$P_B$ä¹Ÿå¾ˆå®¹æ˜“è®¡ç®—å‡ºæ¥ï¼Œå¦‚ä¸‹ï¼š

$$P_A = ï¼ˆ3+1+2ï¼‰/ 15 = 0.4$$
$$P_B= ï¼ˆ2+3ï¼‰/10 = 0.5$$

é—®é¢˜æ¥äº†ï¼Œå¦‚æœæˆ‘ä»¬ä¸çŸ¥é“æŠ›çš„ç¡¬å¸æ˜¯Aè¿˜æ˜¯Bå‘¢ï¼ˆå³ç¡¬å¸ç§ç±»æ˜¯éšå˜é‡ï¼‰ï¼Œç„¶åå†è½®æµæŠ›äº”è½®ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š

| ç¡¬å¸    | ç»“æœ       | ç»Ÿè®¡    |
| ------- | ---------- | ------- |
| Unknown | æ­£æ­£åæ­£å | 3æ­£-2å |
| Unknown | ååæ­£æ­£å | 2æ­£-3å |
| Unknown | æ­£åååå | 1æ­£-4å |
| Unknown | æ­£ååæ­£æ­£ | 3æ­£-2å |
| Unknown | åæ­£æ­£åå | 2æ­£-3å |

OKï¼Œé—®é¢˜å˜å¾—æœ‰æ„æ€äº†ã€‚ç°åœ¨æˆ‘ä»¬çš„ç›®æ ‡æ²¡å˜ï¼Œè¿˜æ˜¯ä¼°è®¡$P_A$å’Œ$P_B$ï¼Œéœ€è¦æ€ä¹ˆåšå‘¢ï¼Ÿ

> æ˜¾ç„¶ï¼Œæ­¤æ—¶æˆ‘ä»¬å¤šäº†ä¸€ä¸ªç¡¬å¸ç§ç±»çš„éšå˜é‡ï¼Œè®¾ä¸º$z$ï¼Œå¯ä»¥æŠŠå®ƒè®¤ä¸ºæ˜¯ä¸€ä¸ª5ç»´çš„å‘é‡$ï¼ˆz_1,z_2,z_3,z_4,z_5)$ï¼Œä»£è¡¨æ¯æ¬¡æŠ•æ·æ—¶æ‰€ä½¿ç”¨çš„ç¡¬å¸ï¼Œæ¯”å¦‚$z_1$ï¼Œå°±ä»£è¡¨ç¬¬ä¸€è½®æŠ•æ·æ—¶ä½¿ç”¨çš„ç¡¬å¸æ˜¯Aè¿˜æ˜¯Bã€‚
>
> - ä½†æ˜¯ï¼Œè¿™ä¸ªå˜é‡$z$ä¸çŸ¥é“ï¼Œå°±æ— æ³•å»ä¼°è®¡$P_A$å’Œ$P_B$ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆä¼°è®¡å‡º$z$ï¼Œç„¶åæ‰èƒ½è¿›ä¸€æ­¥ä¼°è®¡$P_A$å’Œ$P_B$ã€‚
> - å¯è¦ä¼°è®¡$z$ï¼Œæˆ‘ä»¬åˆå¾—çŸ¥é“$P_A$å’Œ$P_B$ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½ä¼°è®¡zï¼Œè¿™ä¸æ˜¯é¸¡ç”Ÿè›‹å’Œè›‹ç”Ÿé¸¡çš„é—®é¢˜å—ï¼Œå¦‚ä½•ç ´ï¼Ÿ

> ç­”æ¡ˆå°±æ˜¯å…ˆéšæœºåˆå§‹åŒ–ä¸€ä¸ª$P_A$å’Œ$P_B$ï¼Œç”¨å®ƒæ¥ä¼°è®¡$z$ï¼Œç„¶ååŸºäº$z$ï¼Œè¿˜æ˜¯æŒ‰ç…§å»ä¼°è®¡æ–°çš„$P_A$å’Œ$P_B$ï¼Œå¦‚æœæ–°çš„$P_A$å’Œ$P_B$å’Œæˆ‘ä»¬åˆå§‹åŒ–çš„$P_A$å’Œ$P_B$ä¸€æ ·ï¼Œè¯·é—®è¿™è¯´æ˜äº†ä»€ä¹ˆï¼Ÿ
>
> è¿™è¯´æ˜æˆ‘ä»¬åˆå§‹åŒ–çš„$P_A$å’Œ$P_B$æ˜¯ä¸€ä¸ªç›¸å½“é è°±çš„ä¼°è®¡ï¼
>
> å°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åˆå§‹åŒ–çš„$P_A$å’Œ$P_B$ï¼Œå¯ä»¥ä¼°è®¡å‡º$z$ï¼Œç„¶ååŸºäº$z$ï¼Œåè¿‡æ¥ä¼°è®¡å‡º$P_1$å’Œ$P_2$ï¼Œå½“ä¸æˆ‘ä»¬åˆå§‹åŒ–çš„$P_A$å’Œ$P_B$ä¸€æ ·æ—¶ï¼Œè¯´æ˜æ˜¯$P_1$å’Œ$P_2$å¾ˆæœ‰å¯èƒ½å°±æ˜¯çœŸå®çš„å€¼ã€‚
>
> å¦‚æœæ–°ä¼°è®¡å‡ºæ¥çš„$P_A$å’Œ$P_B$å’Œæˆ‘ä»¬åˆå§‹åŒ–çš„å€¼å·®åˆ«å¾ˆå¤§ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿå°±æ˜¯ç»§ç»­ç”¨æ–°çš„$P_1$å’Œ$P_2$è¿­ä»£ï¼Œç›´è‡³æ”¶æ•›ã€‚

æˆ‘ä»¬ä¸å¦¨è¿™æ ·ï¼Œå…ˆéšä¾¿ç»™$P_A$å’Œ$P_B$èµ‹ä¸€ä¸ªå€¼ï¼Œæ¯”å¦‚ï¼š
ç¡¬å¸Aæ­£é¢æœä¸Šçš„æ¦‚ç‡$P_A = 0.2$
ç¡¬å¸Bæ­£é¢æœä¸Šçš„æ¦‚ç‡$P_B = 0.7$

ç„¶åï¼Œæˆ‘ä»¬çœ‹çœ‹ç¬¬ä¸€è½®æŠ›æ·æœ€å¯èƒ½æ˜¯å“ªä¸ªç¡¬å¸ã€‚
å¦‚æœæ˜¯ç¡¬å¸Aï¼Œå¾—å‡º3æ­£2åçš„æ¦‚ç‡ä¸º $0.2*0.2*0.2*0.8*0.8 = 0.00512$
å¦‚æœæ˜¯ç¡¬å¸Bï¼Œå¾—å‡º3æ­£2åçš„æ¦‚ç‡ä¸º$0.7*0.7*0.7*0.3*0.3=0.03087$
ç„¶åä¾æ¬¡æ±‚å‡ºå…¶ä»–4è½®ä¸­çš„ç›¸åº”æ¦‚ç‡ã€‚åšæˆè¡¨æ ¼å¦‚ä¸‹ï¼ˆæ ‡ç²—è¡¨ç¤ºå…¶æ¦‚ç‡æ›´å¤§ï¼‰ï¼š

| è½®æ•° | è‹¥æ˜¯ç¡¬å¸A                                   | è‹¥æ˜¯ç¡¬å¸B            |
| ---- | ------------------------------------------- | -------------------- |
| 1    | 0.00512ï¼Œå³0.2 0.2 0.2 0.8 0.8ï¼Œ3æ­£-2å     | **0.03087**ï¼Œ3æ­£-2å |
| 2    | **0.02048**ï¼Œå³0.2 0.2 0.8 0.8 0.8ï¼Œ2æ­£-3å | 0.01323ï¼Œ2æ­£-3å     |
| 3    | **0.08192**ï¼Œå³0.2 0.8 0.8 0.8 0.8ï¼Œ1æ­£-4å | 0.00567ï¼Œ1æ­£-4å     |
| 4    | 0.00512ï¼Œå³0.2 0.2 0.2 0.8 0.8ï¼Œ3æ­£-2å     | **0.03087**ï¼Œ3æ­£-2å |
| 5    | **0.02048**ï¼Œå³0.2 0.2 0.8 0.8 0.8ï¼Œ2æ­£-3å | 0.01323ï¼Œ2æ­£-3å     |

æŒ‰ç…§æœ€å¤§ä¼¼ç„¶æ³•åˆ™ï¼š

- ç¬¬1è½®ä¸­æœ€æœ‰å¯èƒ½çš„æ˜¯ç¡¬å¸B
- ç¬¬2è½®ä¸­æœ€æœ‰å¯èƒ½çš„æ˜¯ç¡¬å¸A
- ç¬¬3è½®ä¸­æœ€æœ‰å¯èƒ½çš„æ˜¯ç¡¬å¸A
- ç¬¬4è½®ä¸­æœ€æœ‰å¯èƒ½çš„æ˜¯ç¡¬å¸B
- ç¬¬5è½®ä¸­æœ€æœ‰å¯èƒ½çš„æ˜¯ç¡¬å¸A

æˆ‘ä»¬å°±æŠŠæ¦‚ç‡æ›´å¤§ï¼Œå³æ›´å¯èƒ½æ˜¯Açš„ï¼Œå³ç¬¬2è½®ã€ç¬¬3è½®ã€ç¬¬5è½®å‡ºç°æ­£çš„æ¬¡æ•°2ã€1ã€2ç›¸åŠ ï¼Œé™¤ä»¥Aè¢«æŠ›çš„æ€»æ¬¡æ•°15ï¼ˆAæŠ›äº†ä¸‰è½®ï¼Œæ¯è½®5æ¬¡ï¼‰ï¼Œä½œä¸ºzçš„ä¼°è®¡å€¼ï¼ŒBçš„è®¡ç®—æ–¹æ³•ç±»ä¼¼ã€‚ç„¶åæˆ‘ä»¬ä¾¿å¯ä»¥æŒ‰ç…§ä¼°è®¡æ–°çš„$P_A$å’Œ$P_B$ã€‚

$P_A = ï¼ˆ2+1+2ï¼‰/15 = 0.33$
$P_B =ï¼ˆ3+3ï¼‰/10 = 0.6$

è®¾æƒ³æˆ‘ä»¬æ˜¯å…¨çŸ¥çš„ç¥ï¼ŒçŸ¥é“æ¯è½®æŠ›æ·æ—¶çš„ç¡¬å¸å°±æ˜¯å¦‚æœ¬æ–‡æœ¬èŠ‚å¼€å¤´æ ‡ç¤ºçš„é‚£æ ·ï¼Œé‚£ä¹ˆï¼Œ$P_A$å’Œ$P_B$çš„ä¼°è®¡å°±æ˜¯0.4å’Œ0.5ï¼ˆä¸‹æ–‡ä¸­å°†è¿™ä¸¤ä¸ªå€¼ç§°ä¸º$P_A$å’Œ$P_B$çš„çœŸå®å€¼ï¼‰ã€‚é‚£ä¹ˆå¯¹æ¯”ä¸‹æˆ‘ä»¬åˆå§‹åŒ–çš„$P_A$å’Œ$P_B$å’Œæ–°ä¼°è®¡å‡ºçš„$P_A$å’Œ$P_B$ï¼š

| åˆå§‹åŒ–çš„$P_A$ | ä¼°è®¡å‡ºçš„$P_A$ | çœŸå®çš„$P_A$ | åˆå§‹åŒ–çš„$P_B$ | ä¼°è®¡å‡ºçš„$P_B$ | çœŸå®çš„$P_B$ |
| ------------- | ------------- | ----------- | ------------- | ------------- | ----------- |
| 0.2           | 0.33          | 0.4         | 0.7           | 0.6           | 0.5         |

çœ‹åˆ°æ²¡ï¼Ÿæˆ‘ä»¬ä¼°è®¡çš„$P_A$å’Œ$P_B$ç›¸æ¯”äºå®ƒä»¬çš„åˆå§‹å€¼ï¼Œæ›´æ¥è¿‘å®ƒä»¬çš„çœŸå®å€¼äº†ï¼å°±è¿™æ ·ï¼Œä¸æ–­è¿­ä»£ä¸æ–­æ¥è¿‘çœŸå®å€¼ï¼Œè¿™å°±æ˜¯EMç®—æ³•çš„å¥‡å¦™ä¹‹å¤„ã€‚

å¯ä»¥æœŸå¾…ï¼Œæˆ‘ä»¬ç»§ç»­æŒ‰ç…§ä¸Šé¢çš„æ€è·¯ï¼Œç”¨ä¼°è®¡å‡ºçš„$P_A$å’Œ$P_B$å†æ¥ä¼°è®¡$z$ï¼Œå†ç”¨$z$æ¥ä¼°è®¡æ–°çš„$P_A$å’Œ$P_B$ï¼Œåå¤è¿­ä»£ä¸‹å»ï¼Œå°±å¯ä»¥æœ€ç»ˆå¾—åˆ°$P_A = 0.4$ï¼Œ$P_B=0.5$ï¼Œæ­¤æ—¶æ— è®ºæ€æ ·è¿­ä»£ï¼Œ$P_A$å’Œ$P_B$çš„å€¼éƒ½ä¼šä¿æŒ0.4å’Œ0.5ä¸å˜ï¼Œäºæ˜¯ä¹ï¼Œæˆ‘ä»¬å°±æ‰¾åˆ°äº†$P_A$å’Œ$P_B$çš„æœ€æœ‰å¯èƒ½çš„ä¼°è®¡å€¼ã€‚

## [é—®é¢˜æ€è€ƒ](#content)

çœ‹å®Œè¿™ä¸¤ä¸ªä¾‹å­ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰æ›´æ¸…æ¥šEMç®—æ³•çš„æ•´ä¸ªæµç¨‹ï¼Œä½†æ˜¯ä½ å¯èƒ½ä¼šæœ‰ä»¥ä¸‹ç–‘é—®ğŸ¤”ï¸ï¼š

- èº«é«˜çš„ä¾‹å­ä¸­æœ€å¼€å§‹çš„åˆ†å¸ƒæƒ…å†µçœŸçš„æ˜¯ççŒœçš„ä¹ˆï¼Ÿ
- ç¡¬å¸çš„ä¾‹å­ä¸­é€šè¿‡zä¼°è®¡$P_A$å’Œ$P_B$æ˜¯é‡‡ç”¨ä»€ä¹ˆæ–¹å¼ä¼°è®¡çš„å‘¢ï¼Ÿ
- ç¡¬å¸ä¸­çš„éšå˜é‡zä»£è¡¨ä»€ä¹ˆï¼Ÿåœ¨èº«é«˜çš„æ¡ˆä¾‹ä¸­å“ªä¸ªæ˜¯éšå˜é‡å‘¢ï¼Ÿ

è¿™å‡ ç‚¹ç–‘é—®å¯ä»¥è¿™æ ·æ¥è§£é‡Šï¼š

- å…¶å®åœ¨èº«é«˜çš„é‚£ä¸ªæ¡ˆä¾‹ä¸­æˆ‘æƒ³å¤§å®¶ä¹Ÿèƒ½å‘ç°ï¼Œæˆ‘ä»¬çŒœæµ‹çš„é‚£å‡ ä¸ªå‚æ•°$\mu_{ç”·}, \sigma_{ç”·} ^ {2},\mu_{å¥³}, \sigma_{å¥³} ^ {2}$è¿˜æ˜¯å¾ˆç¬¦åˆçœŸå®æƒ…å†µçš„ï¼Œå°±åƒèº«é«˜188ï¼Œæˆ‘ä»¬è®¡ç®—ä¹‹åç¡®å®æ˜¯ç”·æ€§çš„å¯èƒ½æ€§ä¼šæ›´å¤§ã€‚è¿™å››ä¸ªå‚æ•°ä¹Ÿä¸æ˜¯æˆ‘èƒ¡ä¹±çŒœæµ‹çš„ï¼Œè€Œæ˜¯æˆ‘åœ¨ç½‘ä¸ŠæŸ¥åˆ°çš„äººç±»èº«é«˜åˆ†å¸ƒæƒ…å†µï¼Œç„¶åæ ¹æ®å›½å®¶ç»Ÿè®¡å±€çš„æ•°æ®åšçš„ä¸€ä¸ªé¢„è®¾ã€‚è¿™ä¸€æ­¥æ•°å­¦åŒ–æ¥è¯´å°±æ˜¯å…ˆéªŒæ¦‚ç‡ã€‚

- åœ¨æŠ›ç¡¬å¸çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬æ˜¯å·²ç»è§‚å¯Ÿåˆ°äº†å‡ æ­£å‡ åï¼Œç„¶ååæ¨æ˜¯å“ªä¸€ä¸ªç¡¬å¸å‡ºç°è¿™ç§æƒ…å†µçš„å¯èƒ½æ€§å¤§ã€‚è¿™ä¸ªç”¨æ•°å­¦åŒ–æ¥è¯´å°±æ˜¯æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚

- ç¡¬å¸ä¸­çš„éšå˜é‡zå°±æ˜¯æˆ‘ä»¬ä¸çŸ¥é“è¿™ä¸ªç¡¬å¸åˆ°åº•æ˜¯Aè¿˜æ˜¯Bï¼Œè¦æ˜¯èƒ½çŸ¥é“è¿™ä¸ªç¡¬å¸æ˜¯Aè¿˜æ˜¯Bé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ç®—å‡ºæ¥Aå’ŒBæ­£é¢æœä¸Šçš„æ¦‚ç‡äº†ã€‚åœ¨èº«é«˜ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸çŸ¥é“å½“å‰è¿™ä¸ªå¿—æ„¿è€…åˆ°åº•æ˜¯ç”·ç”Ÿè¿˜æ˜¯å¥³ç”Ÿï¼Œå¦‚æœçŸ¥é“çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç”·å¥³æ¯”ä¾‹$\pi_{ç”·},\pi_{å¥³}$å°±å·²çŸ¥äº†ã€‚è€Œä¸”è¦æ˜¯çŸ¥é“å“ªå‡ ä¸ªæ˜¯ç”·æ€§çš„è¯ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨ç”·æ€§èº«é«˜æ•°æ®çš„å‚æ•°ä¼°è®¡å°±ç›´æ¥èƒ½å¾—åˆ°$\mu_{ç”·}, \sigma_{ç”·} ^ {2}$ï¼Œä¹Ÿå°±ä¸ç”¨å†é‚£ä¹ˆå¤æ‚çš„è®¡ç®—äº†ã€‚

æ‰€ä»¥EMç®—æ³•çš„æµç¨‹å°±æ˜¯è¿™æ ·ï¼š

1. å…ˆç»™å‡ºæ•°æ®çš„å…ˆéªŒæ¦‚ç‡ï¼Œæ¥å‡è®¾å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æˆ‘ä»¬ç»Ÿä¸€ç”¨$\theta$æ¥è¡¨ç¤º
2. ç„¶åæ ¹æ®å½“å‰çš„æ•°æ®å’Œå‚æ•°$\theta$ï¼Œæ¥è®¡ç®—ä¸€ä¸‹è¿™ä¸ªéšå˜é‡çš„å¯èƒ½çš„å€¼(è¿™ä¸ªå€¼ç”¨æ•°å­¦åŒ–è¡¨è¿°å°±æ˜¯éšå˜é‡åœ¨æ¡ä»¶æ˜¯çš„æƒ…å†µä¸‹çš„æ•°å­¦æœŸæœ›)ã€‚
3. æ ¹æ®è®¡ç®—å‡ºæ¥çš„éšå˜é‡å¯èƒ½çš„å€¼ï¼Œåè¿‡æ¥ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡çš„æ–¹æ³•æ¨å€’å‘ç”Ÿè¿™æ ·çš„æƒ…å†µä¸‹ï¼Œå‚æ•°$\theta$çš„æœ€ä¼˜è§£æ˜¯å¤šå°‘ï¼Ÿ
4. é€šè¿‡ä¸€æ¬¡è®¡ç®—æˆ‘ä»¬è‚¯å®šä¸èƒ½çŸ¥é“$\theta$æ˜¯ä¸æ˜¯æœ€ä¼˜å€¼ï¼Œæˆ‘ä»¬è¿˜è¦ç»§ç»­æ‰§è¡Œ2ï¼Œ3ä¸¤æ­¥ï¼Œç›´åˆ°å‚æ•°å·²ç»å˜åŒ–ä¸å¤§äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ¤å®šè¿™ä¸ª$\theta$æ”¶æ•›åˆ°äº†ä¸€ä¸ªè¿‘ä¼¼çš„æœ€ä¼˜è§£ã€‚

## [æ•°å­¦æ¨å¯¼](#content)

å‡å®šæˆ‘ä»¬ç°åœ¨æœ‰è®­ç»ƒé›†$\left\{x^{(1)}, x^{(2)}, \cdots, x^{(m)}\right\}$ï¼ŒåŒ…å«mä¸ªç‹¬ç«‹çš„æ ·æœ¬ï¼Œæˆ‘ä»¬ç°åœ¨å¸Œæœ›ä»ä¸­æ‰¾åˆ°è¯¥ç»„æ•°æ®çš„æ¨¡å‹çš„å‚æ•°$\theta$ã€‚ä¸ºäº†æ±‚è§£è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å…ˆå–å‚æ•°çš„å¯¹æ•°æå¤§ä¼¼ç„¶
$$
l(\theta)=\sum_{i=1}^{m} \log p(x^{i} ; \theta)
$$
ä½†æ˜¯æˆ‘ä»¬ä¸è¦å¿˜äº†ï¼Œæˆ‘ä»¬è¿˜æœ‰éšå˜é‡$z=$$
\left(z^{1}, z^{2}, \ldots z^{m}\right)
$ï¼Œæˆ‘ä»¬ä¹Ÿè¦æŠŠzæ·»åŠ åˆ°ä¼¼ç„¶å‡½æ•°å½“ä¸­å»
$$
l(\theta)=\sum_{i=1}^{m} \log \sum_{z} p(x^{i}, z ; \theta)
$$
æ­£å¸¸æå¤§ä¼¼ç„¶ä¼°è®¡æ˜¯æœ€å¤§åŒ–ä¸Šé¢é‚£ä¸ªå¼å­ï¼Œæ±‚å¯¼ä»¤å…¶å¾—0æ±‚å¾—å‚æ•°å€¼ï¼Œä½†æ˜¯è¿™é‡Œæ˜æ˜¾æ— æ³•ç›´æ¥æ±‚å‡ºå‚æ•°çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€äº›æŠ€å·§æ¥æ±‚è§£è¿™ä¸ªä¼¼ç„¶å‡½æ•°ã€‚

æˆ‘ä»¬ä»¤$Q_i$ä»£è¡¨éšå˜é‡$z$çš„ä¸€ä¸ªåˆ†å¸ƒï¼Œç°åœ¨æˆ‘ä»¬æ¥æ”¹é€ ä¸€ä¸‹ä¼¼ç„¶å‡½æ•°(è¿™é‡Œå°±æ˜¯ä¸Šä¸‹åŒæ—¶ä¹˜ä»¥$Q_i$)
$$
\begin{aligned}
l(\theta)=\sum_{i=1}^{m} \log \sum_{z} P\left(x^{i}, z ; \theta\right) &=\sum_{i=1}^{m} \log \sum_{Z^{(i)}} Q_{i}\left(z^{(i)}\right) \frac{P\left(x^{(i)}, z^{(i)} ; \theta\right)}{Q_{i}\left(z^{(i)}\right)}           \\
& \geq \sum_{i=1}^{m} \sum_{z^{(i)}} Q_{i}\left(z^{(i)}\right) \log \frac{P\left(x^{(i)}, z^{(i)} ; \theta\right)}{Q_{i}\left(z^{(i)}\right)}
\end{aligned}
$$
è¿™é‡Œæˆ‘ä»¬è¿˜è¦æ³¨æ„ä¸€ä¸‹è¿™ä¸ªå¼å­
$$
\sum_{z^{(i)}} Q_{i}\left(z^{(i)}\right)\frac{p\left(x^{(i)}, z^{(i)} ; \theta\right)}{Q_{i}\left(z^{(i)}\right)}
$$
è¿™ä¸ªä»£è¡¨ä»€ä¹ˆæ„æ€å‘€ï¼Ÿè¿™ä¸ªä¸å°±æ˜¯$\frac{p\left(x^{(i)}, z^{(i)} ; \theta\right)}{Q_{i}\left(z^{(i)}\right)}$çš„æœŸæœ›ä¹ˆï¼Ÿï¼ˆä¸ç†è§£çš„å¯ä»¥ç¿»çœ‹ä¸€ä¸‹æœŸæœ›çš„å…¬å¼ï¼‰

è¿™é‡Œç”¨åˆ°äº†<a href = "#Jensenä¸ç­‰å¼">Jensenä¸ç­‰å¼</a>ï¼Œå°†ç­‰å·å˜ä¸ºå¤§äºç­‰äºå·ï¼Œè€Œä¸”å› ä¸ºè¿™é‡Œçš„å¯¹æ•°å‡½æ•°ä¸ºå‡¹å‡½æ•°ï¼Œæ‰€ä»¥å¾—å‡ºè¿™ä¸ªç»“è®º
$$
f(E(x)) \geq E(f(x)) \quad \text { å¦‚æœ } f(x) \text { æ˜¯å‡¹å‡½æ•° }
$$
ä½†æ˜¯æˆ‘ä»¬è¿˜è¦è€ƒè™‘çš„ä¸€ç‚¹æ˜¯ï¼Œä»€ä¹ˆæƒ…å†µä¸‹æ‰èƒ½å–åˆ°è¿™ä¸ªç­‰å·ã€‚
$$
\frac{P\left(x^{(i)}, z^{(i)} ; \theta\right)}{Q_{i}\left(z^{(i)}\right)}=c, c \text { ä¸ºå¸¸æ•° }
$$
æˆ‘ä»¬åªæœ‰ä»¤ä¸Šé¢è¿™ä¸ªå¼å­ç­‰äºcä¹Ÿå°±æ˜¯ä¸ºä¸€ä¸ªå®šå€¼æ—¶æ‰èƒ½å–åˆ°ç­‰å·ã€‚è€Œä¸”$Q_i$æ˜¯ä¸€ä¸ªåˆ†å¸ƒï¼Œæ‰€ä»¥æ»¡è¶³
$$
\sum_{z} Q_{i}\left(z^{(i)}\right)=1
$$
è¿™æ ·ç»“åˆä¸Šé¢çš„å…¬å¼ï¼Œæˆ‘ä»¬å¾—åˆ°è¿™æ ·ä¸€ä¸ªç»“æœ
$$
\left.Q_{i}\left(z^{(i)}\right)=\frac{P\left(x^{(i)}, z^{(i)} ; \theta\right)}{\sum_{z} P\left(x^{(i)}, z^{(i)} ; \theta\right)}=\frac{P\left(x^{(i)}, z^{(i)} ; \theta\right)}{P\left(x^{(i)} ; \theta\right)}=P\left(z^{(i)} | x^{(i)} ; \theta\right)\right.
$$
ä¹Ÿå°±æ˜¯è¯´ä»¤$Q_i$ä¸º$\theta$çš„ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡æ—¶å°±å¯ä»¥æ»¡è¶³ä¸Šé¢çš„æ¡ä»¶ã€‚åˆ°è¿™é‡Œå°±æ˜¯EMç®—æ³•ä¸­çš„Eã€‚

ç°åœ¨å¦‚æœæˆ‘ä»¬æå¤§åŒ–è¿™ä¸ªå¼å­
$$
\theta := \arg \max _{\theta} \sum_{i=1}^{m} \sum_{z^{(i)}} Q_{i}\left(z^{(i)}\right) \log \frac{P\left(x^{(i)}, z^{(i)} ; \theta\right)}{Q_{i}\left(z^{(i)}\right)}
$$
ä¹Ÿå°±æ„å‘³ç€åœ¨å¯»æ‰¾ä¼¼ç„¶å‡½æ•°$l(\theta)$çš„ä¸‹ç•Œã€‚å‘ç°æ²¡æœ‰æˆ‘ä»¬å°†åŸæ¥å¤æ‚çš„ä¸€ä¸ªé—®é¢˜ç®€å•åŒ–äº†ï¼Œç°åœ¨æˆ‘ä»¬å°½å¯èƒ½çš„è®©ä¸Šé¢çš„å¼å­æ±‚å…¶æœ€å¤§å€¼ï¼Œç›´åˆ°è¿™ä¸ªæœ€å¤§å€¼ç­‰äºåŸæœ¬çš„ä¼¼ç„¶å‡½æ•°$l(\theta)$ï¼Œæˆ‘ä»¬ä¹Ÿå°±é—´æ¥çš„å¾—åˆ°äº†ä¼¼ç„¶å‡½æ•°$l(\theta)$çš„æå¤§å€¼ï¼Œæœ‰ç‚¹ç»•ï¼Œä½†æ˜¯æˆ‘ä»¬èƒ½å¾—åˆ°ä¸€ä¸ªä¿¡æ¯ï¼Œå°±æ˜¯å¯ä»¥æ±‚ä¼¼ç„¶å‡½æ•°çš„æå¤§å€¼äº†ã€‚è¿™ä¸ªä¸‹ç•Œæˆ‘ä»¬ä¸å¦¨ç”¨$J$æ¥è¡¨ç¤ºï¼Œä¸”$J$ä¸$Q_i$æœ‰å…³ã€‚

![theta](img/theta.jpeg)

å›ºå®š$\theta_{1}$ï¼Œè°ƒæ•´$Q_i$ä½¿ä¸‹ç•Œ$J$ä¸ä¼¼ç„¶å‡½æ•°åœ¨$\theta_{1}$ç‚¹å¤„ç›¸ç­‰ï¼Œç„¶åå›ºå®š$Q_i$ï¼Œè°ƒæ•´$\theta$ä½¿å¾—ä¸‹ç•Œ$J$è¾¾åˆ°æœ€å¤§å€¼ï¼Œæ­¤æ—¶å¾—åˆ°æ–°çš„$\theta_{2}$ï¼Œç„¶åå†å›ºå®š$\theta_{2}$ï¼Œè°ƒæ•´$Q_i$ä½¿å¾—ä¸‹ç•Œ$J$ä¸ä¼¼ç„¶å‡½æ•°ç›¸ç­‰ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æ”¶æ•›è‡³ä¼¼ç„¶å‡½æ•°çš„æœ€å¤§å€¼ã€‚

ç°åœ¨æˆ‘ä»¬æŠŠä¸Šé¢å¼å­ä¸­çš„å¸¸æ•°é¡¹å»æ‰å†çœ‹ä¸€ä¸‹
$$
\theta := \arg \max _{\theta} \sum_{i=1}^{m} \sum_{z^{(i)}} Q_{i}\left(z^{(i)}\right) \log P\left(x^{(i)}, z^{(i)} ; \theta\right)
$$
ä¸Šé¢è¿™ä¸ªå¼å­å°±æ˜¯EMç®—æ³•ä¸­çš„Mã€‚

è‡³æ­¤æ•´ä¸ªEMç®—æ³•çš„æ•°å­¦å…¬å¼æ¨å¯¼è¿‡ç¨‹å·²ç»å®Œæ¯•äº†ã€‚

## [EMç®—æ³•æµç¨‹](#content)

å‚è€ƒè‡ªEMç®—æ³•åŸç†æ€»ç»“$^{[4]}$ã€‚

EMç®—æ³•çš„æ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š

è¾“å…¥ï¼šæ•°æ®$\left\{x^{(1)}, x^{(2)}, \cdots, x^{(m)}\right\}$ï¼Œæœ€å¤§è¿­ä»£æ¬¡æ•°J

ï¼ˆ1ï¼‰å…ˆéªŒç»™å‡ºæ¨¡å‹çš„åˆå§‹åŒ–å‚æ•°$\theta$

ï¼ˆ2ï¼‰for i from 1 to J:

â€‹    ï¼ˆaï¼‰E: è®¡ç®—æœŸæœ›
$$
\begin{aligned}
&\left.Q_{i}\left(z^{(i)}\right)=P\left(z^{(i)} | x^{(i)}, \theta^{j}\right)\right)\\
&L\left(\theta, \theta^{j}\right)=\sum_{i=1}^{m} \sum_{z^{(i)}} Q_{i}\left(z^{(i)}\right) \log P\left(x^{(i)}, z^{(i)} ; \theta\right)
\end{aligned}
$$
â€‹    ï¼ˆbï¼‰M: æœ€å¤§åŒ–$L\left(\theta, \theta^{j}\right)$ï¼Œå¾—åˆ°$\theta^{j+1}$ï¼š
$$
\theta^{j+1}=\arg \max _{\theta} L\left(\theta, \theta^{j}\right)
$$
â€‹    ï¼ˆcï¼‰å¦‚æœå·²æ”¶æ•›ï¼Œåˆ™ç®—æ³•ç»“æŸï¼Œå¦åˆ™ç»§ç»­å›åˆ°æ­¥éª¤ï¼ˆaï¼‰è¿›è¡Œè¿­ä»£

è¾“å‡ºï¼šæ¨¡å‹å‚æ•°$\theta$

## [ä»£ç å®ç°](#content)

### [äºŒç»´é«˜æ–¯åˆ†å¸ƒ](#content)

å¤šç»´å˜é‡$X=(x_1,x_2,...,x_n)$çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼š

$$
f(X)=\frac{1}{(2 \pi)^{d / 2}|\Sigma|^{1 / 2}} \exp \left[-\frac{1}{2}(X-u)^{T} \Sigma^{-1}(X-u)\right], X=\left(x_{1}, x_{2} \dots x_{n}\right)
$$

å…¶ä¸­ï¼š

ã€€ã€€- $d$ï¼šå˜é‡ç»´åº¦ã€‚å¯¹äºäºŒç»´é«˜æ–¯åˆ†å¸ƒï¼Œæœ‰d=2;
  
ã€€ã€€- $u=(u_1,u_2,...,u_n)$ï¼šå„ä½å˜é‡çš„å‡å€¼ï¼›
  
ã€€ã€€- $Î£$ï¼šåæ–¹å·®çŸ©é˜µï¼Œæè¿°å„ç»´å˜é‡ä¹‹é—´çš„ç›¸å…³åº¦ã€‚å¯¹äºäºŒç»´é«˜æ–¯åˆ†å¸ƒï¼Œæœ‰ï¼š

$$
\Sigma=\left(\begin{array}{ll}
\delta_{11} & \delta_{12} \\
\delta_{21} & \delta_{22}
\end{array}\right)
$$

### [æ•°æ®å¯è§†åŒ–](#content)

**ç¬¬ä¸€ä¸ªä¾‹å­**
$$
u=(0.5 \quad 0.5), \Sigma=\left(\begin{array}{ll}
1 & 0 \\
0 & 3
\end{array}\right)
$$
![ex1](img/ex1.png)

ç¬¬äºŒä¸ªä¾‹å­**
$$
u=(5.5 \quad 2.5), \Sigma=\left(\begin{array}{ll}
2 & 0 \\
0 & 2
\end{array}\right)
$$
![ex2](img/ex2.png)

**ç¬¬ä¸‰ä¸ªä¾‹å­**
$$
u=(1 \quad 7), \Sigma=\left(\begin{array}{ll}
6 & 0 \\
0 & 2
\end{array}\right)
$$
![ex3](img/ex3.png)

**ç¬¬å››ä¸ªä¾‹å­**
$$
u=(9 \quad 4.5), \Sigma=\left(\begin{array}{ll}
1 & -1 \\
-1 & 3
\end{array}\right)
$$
![ex4](img/ex4.png)

**æ±‡æ€»å›¾**

![clusters](img/clusters.png)



### [å˜é‡åˆå§‹åŒ–](#content)
é¦–å…ˆè¦å¯¹GMMæ¨¡å‹å‚æ•°ä»¥åŠéšå˜é‡è¿›è¡Œåˆå§‹åŒ–ã€‚é€šå¸¸å¯ä»¥ç”¨ä¸€äº›å›ºå®šçš„å€¼æˆ–è€…éšæœºå€¼ã€‚

- n_clustersæ˜¯GMMæ¨¡å‹ä¸­èšç±»çš„ä¸ªæ•°ï¼Œå’ŒK-Meansä¸€æ ·æˆ‘ä»¬éœ€è¦æå‰ç¡®å®šã€‚è¿™é‡Œæˆ‘ä»¬é™¤å»å€¾æ–œçš„è“è‰²æ•°æ®ï¼Œæ‰€ä»¥èšç±»ä¸ªæ•°ä¸º3ã€‚

- n_pointsæ˜¯æ ·æœ¬ç‚¹çš„ä¸ªæ•°ã€‚

- Muæ˜¯æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒçš„å‡å€¼ã€‚

- Varæ˜¯æ¯ä¸ªé«˜æ–¯åˆ†å¸ƒçš„æ–¹å·®ï¼Œä¸ºäº†è¿‡ç¨‹ç®€ä¾¿ï¼Œæˆ‘ä»¬è¿™é‡Œå‡è®¾åæ–¹å·®çŸ©é˜µéƒ½æ˜¯å¯¹è§’é˜µã€‚

- Wæ˜¯ä¸Šé¢æåˆ°çš„éšå˜é‡ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªæ ·æœ¬å±äºæ¯ä¸€ç°‡çš„æ¦‚ç‡ï¼Œåœ¨åˆå§‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ¯ä¸ªæ ·æœ¬å±äºæŸä¸€ç°‡çš„æ¦‚ç‡éƒ½æ˜¯1/3ã€‚

- Piæ˜¯æ¯ä¸€ç°‡çš„æ¯”é‡ï¼Œå¯ä»¥æ ¹æ®Wæ±‚å¾—ï¼Œåœ¨åˆå§‹æ—¶ï¼ŒPi = [1/3, 1/3, 1/3]

**æ³¨ï¼šå¦‚ä½•ç¡®å®šGMMä¸­çš„èšç±»ä¸ªæ•°**

- æ–¹æ³•ä¸€ï¼šBIC

$$
BIC=âˆ’2log(L)+klog(n)
$$

Læ˜¯likelihoodï¼Œkæ˜¯componentçš„ä¸ªæ•°ï¼Œnæ˜¯æ ·æœ¬çš„ä¸ªæ•°ã€‚

- æ–¹æ³•äºŒï¼šcross validation

å¦ä¸€ä¸ªæ–¹æ³•æ˜¯æ ¹æ®split testçš„ç»“æœï¼ˆæˆ–è€…è¯´cross validationçš„ç»“æœï¼‰ï¼Œå…ˆç”¨è®­ç»ƒé›†å¾—åˆ°GMMçš„å‚æ•°ï¼Œç„¶åå†åœ¨æµ‹è¯•é›†ä¸Šè®¡ç®—log-likelihoodã€‚ä¸¤è€…æ˜æ˜¾åˆ†å‰çš„åœ°æ–¹å°±æ˜¯componentä¸ªæ•°çš„æœ€ä½³å€™é€‰ã€‚

![](img/clusters-likehood.png)

å‚è€ƒï¼š[https://scikit-learn.org/stable/auto_examples/mixture/plot_gmm_selection.html#sphx-glr-auto-examples-mixture-plot-gmm-selection-py](https://scikit-learn.org/stable/auto_examples/mixture/plot_gmm_selection.html#sphx-glr-auto-examples-mixture-plot-gmm-selection-py)

```python
n_clusters = 3
n_points = len(X)
Mu = [[0, -1], [6, 0], [0, 9]]
Var = [[1, 1], [1, 1], [1, 1]]
Pi = [1 / n_clusters] * 3
W = np.ones((n_points, n_clusters)) / n_clusters 
Pi = W.sum(axis=0) / W.sum()
```



### [Eæ­¥éª¤](#content)

$$
\left.Q_{i}\left(z^{(i)}\right)=P\left(z^{(i)} | x^{(i)}, \theta^{j}\right)\right)
$$

Eæ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬çš„ä¸»è¦ç›®çš„æ˜¯æ›´æ–°Wã€‚ç¬¬iä¸ªå˜é‡å±äºç¬¬mç°‡çš„æ¦‚ç‡ä¸ºï¼š
$$
W_{i, m}=\frac{\pi_{j} P\left(X_{i} | \mu_{m}, \operatorname{var}_{m}\right)}{\sum_{j=1}^{3} \pi_{j} P\left(X_{i} | \mu_{j}, \operatorname{var}_{j}\right)}
$$
æ ¹æ®Wï¼Œæˆ‘ä»¬å°±å¯ä»¥æ›´æ–°æ¯ä¸€ç°‡çš„å æ¯”$\pi_{m}$ï¼Œ
$$
\pi_{m}=\frac{\sum_{i=1}^{n} W_{i, m}}{\sum_{j=1}^{k} \sum_{i=1}^{n} W_{i, j}}
$$

```python
def update_W(X, Mu, Var, Pi):
    n_points, n_clusters = len(X), len(Pi)
    pdfs = np.zeros(((n_points, n_clusters)))
    for i in range(n_clusters):
        # multivariate_normal.pdfï¼šå¤šå…ƒæ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°
        pdfs[:, i] = Pi[i] * multivariate_normal.pdf(X, Mu[i], np.diag(Var[i]))
    W = pdfs / pdfs.sum(axis=1).reshape(-1, 1)
    return W


def update_Pi(W):
    Pi = W.sum(axis=0) / W.sum()
    return Pi
```

ä»¥ä¸‹æ˜¯è®¡ç®—å¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„logLHä»¥åŠç”¨æ¥å¯è§†åŒ–æ•°æ®çš„plot_clustersã€‚

$$
L\left(\theta, \theta^{\prime}\right)=\sum_{i=1}^{m} \sum_{z^{(i)}} Q_{i}\left(z^{(i)}\right) \log P\left(x^{(i)}, z^{(i)} ; \theta\right)
$$

```python
def logLH(X, Pi, Mu, Var):
    n_points, n_clusters = len(X), len(Pi)
    pdfs = np.zeros(((n_points, n_clusters)))
    for i in range(n_clusters):
        pdfs[:, i] = Pi[i] * multivariate_normal.pdf(X, Mu[i], np.diag(Var[i]))
    return np.mean(np.log(pdfs.sum(axis=1)))


def plot_clusters(X, Mu, Var, Mu_true=None, Var_true=None):
    colors = ['b', 'g', 'r']
    n_clusters = len(Mu)
    plt.figure(figsize=(10, 8))
    plt.axis([-10, 15, -5, 15])
    plt.scatter(X[:, 0], X[:, 1], s=5)
    ax = plt.gca()
    for i in range(n_clusters):
        plot_args = {'fc': 'None', 'lw': 2, 'edgecolor': colors[i], 'ls': ':'}
        ellipse = Ellipse(Mu[i], 3 * Var[i][0], 3 * Var[i][1], **plot_args)
        ax.add_patch(ellipse)
    if (Mu_true is not None) & (Var_true is not None):
        for i in range(n_clusters):
            plot_args = {'fc': 'None', 'lw': 2, 'edgecolor': colors[i], 'alpha': 0.5}
            ellipse = Ellipse(Mu_true[i], 3 * Var_true[i][0], 3 * Var_true[i][1], **plot_args)
            ax.add_patch(ellipse)         
    plt.show()
```

### [Mæ­¥éª¤](#content)

Mæ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä¸Šé¢ä¸€æ­¥å¾—åˆ°çš„Wæ¥æ›´æ–°å‡å€¼Muå’Œæ–¹å·®Varã€‚ Muå’ŒVaræ˜¯ä»¥Wçš„æƒé‡çš„æ ·æœ¬Xçš„å‡å€¼å’Œæ–¹å·®ã€‚

å› ä¸ºè¿™é‡Œçš„æ•°æ®æ˜¯äºŒç»´çš„ï¼Œç¬¬mç°‡çš„ç¬¬kä¸ªåˆ†é‡çš„å‡å€¼ï¼Œ

$$
\mu_{m, k}=\frac{\sum_{i=1}^{n} W_{i, m} X_{i, k}}{\sum_{i=1}^{n} W_{i, m}}
$$

ç¬¬mç°‡çš„ç¬¬kä¸ªåˆ†é‡çš„æ–¹å·®ï¼Œ

$$
\operatorname{var}_{m, k}=\frac{\sum_{i=1}^{n} W_{i, m}\left(X_{i, k}-\mu_{m, k}\right)^{2}}{\sum_{i=1}^{n} W_{i, m}}
$$

ä»¥ä¸Šè¿­ä»£å…¬å¼å†™æˆå¦‚ä¸‹å‡½æ•°update_Muå’Œupdate_Varã€‚

```python
def update_Mu(X, W):
    n_clusters = W.shape[1]
    Mu = np.zeros((n_clusters, 2))
    for i in range(n_clusters):
        Mu[i] = np.average(X, axis=0, weights=W[:, i])
    return Mu

def update_Var(X, Mu, W):
    n_clusters = W.shape[1]
    Var = np.zeros((n_clusters, 2))
    for i in range(n_clusters):
        Var[i] = np.average((X - Mu[i]) ** 2, axis=0, weights=W[:, i])
    return Var
```

### [è¿­ä»£æ±‚è§£](#content)

ä¸‹é¢æˆ‘ä»¬è¿›è¡Œè¿­ä»£æ±‚è§£ã€‚

å›¾ä¸­å®çº¿æ˜¯çœŸå®çš„é«˜æ–¯åˆ†å¸ƒï¼Œè™šçº¿æ˜¯æˆ‘ä»¬ä¼°è®¡å‡ºçš„é«˜æ–¯åˆ†å¸ƒã€‚å¯ä»¥çœ‹å‡ºï¼Œç»è¿‡5æ¬¡è¿­ä»£ä¹‹åï¼Œä¸¤è€…å‡ ä¹å®Œå…¨é‡åˆã€‚

```python
loglh = []
for i in range(5):
    plot_clusters(X, Mu, Var, [mu1, mu2, mu3], [var1, var2, var3])
    loglh.append(logLH(X, Pi, Mu, Var))
    W = update_W(X, Mu, Var, Pi)
    Pi = update_Pi(W)
    Mu = update_Mu(X, W)
    print('log-likehood:%.3f'%loglh[-1])
    Var = update_Var(X, Mu, W)
```

æ¯æ¬¡è¿­ä»£çš„log-likehoodå¦‚ä¸‹

```python
log-likehood:-8.163
log-likehood:-4.701
log-likehood:-4.698
log-likehood:-4.697
log-likehood:-4.697
```

![](img/em1.png)
![](img/em2.png)
![](img/em3.png)
![](img/em4.png)
![](img/em5.png)

### [å®Œæ•´ä»£ç ](#content)

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Ellipse
from scipy.stats import multivariate_normal
plt.style.use('seaborn')

def generate_X(true_Mu, true_Var):
    '''
    ç”Ÿæˆä¸‰ä¸ªé«˜æ–¯åˆ†å¸ƒæ•°æ®
    :param true_Mu: å‡å€¼
    :param true_Var: æ–¹å·®
    :return:
    '''
    # ç¬¬ä¸€ç°‡çš„æ•°æ®
    num1, mu1, var1 = 400, true_Mu[0], true_Var[0]
    X1 = np.random.multivariate_normal(mu1, np.diag(var1), num1)
    # ç¬¬äºŒç°‡çš„æ•°æ®
    num2, mu2, var2 = 600, true_Mu[1], true_Var[1]
    X2 = np.random.multivariate_normal(mu2, np.diag(var2), num2)
    # ç¬¬ä¸‰ç°‡çš„æ•°æ®
    num3, mu3, var3 = 1000, true_Mu[2], true_Var[2]
    X3 = np.random.multivariate_normal(mu3, np.diag(var3), num3)
    # åˆå¹¶åœ¨ä¸€èµ·
    X = np.vstack((X1, X2, X3))
    # æ˜¾ç¤ºæ•°æ®
    plt.figure(figsize=(10, 8))
    plt.axis([-10, 15, -5, 15])
    plt.scatter(X1[:, 0], X1[:, 1], s=5)
    plt.scatter(X2[:, 0], X2[:, 1], s=5)
    plt.scatter(X3[:, 0], X3[:, 1], s=5)
    plt.show()
    return X

# Eæ­¥éª¤æ›´æ–°Wï¼Œä¹Ÿå°±æ˜¯ç¬¬iä¸ªå˜é‡å±äºç¬¬mç°‡çš„æ¦‚ç‡
# æ›´æ–°W
def update_W(X, Mu, Var, Pi):
    n_points, n_clusters = len(X), len(Pi)
    pdfs = np.zeros(((n_points, n_clusters)))
    for i in range(n_clusters):
        # multivariate_normal.pdfï¼šå¤šå…ƒæ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°
        pdfs[:, i] = Pi[i] * multivariate_normal.pdf(X, Mu[i], np.diag(Var[i]))
    W = pdfs / pdfs.sum(axis=1).reshape(-1, 1)
    return W

# æ ¹æ®æ›´æ–°çš„Wï¼Œæ›´æ–°æ¯ä¸€ç°‡çš„å æ¯”
# æ›´æ–°pi
def update_Pi(W):
    Pi = W.sum(axis=0) / W.sum()
    return Pi


# è®¡ç®—logä¼¼ç„¶å‡½æ•°
def logLH(X, Pi, Mu, Var):
    n_points, n_clusters = len(X), len(Pi)
    pdfs = np.zeros(((n_points, n_clusters)))
    for i in range(n_clusters):
        pdfs[:, i] = Pi[i] * multivariate_normal.pdf(X, Mu[i], np.diag(Var[i]))
    return np.mean(np.log(pdfs.sum(axis=1)))


# ç”»å‡ºèšç±»å›¾åƒ
def plot_clusters(X, Mu, Var, Mu_true=None, Var_true=None):
    colors = ['b', 'g', 'r']
    n_clusters = len(Mu)
    plt.figure(figsize=(10, 8))
    plt.axis([-10, 15, -5, 15])
    plt.scatter(X[:, 0], X[:, 1], s=5)
    ax = plt.gca()
    for i in range(n_clusters):
        plot_args = {'fc': 'None', 'lw': 2, 'edgecolor': colors[i], 'ls': ':'}
        ellipse = Ellipse(Mu[i], 3 * Var[i][0], 3 * Var[i][1], **plot_args)
        ax.add_patch(ellipse)
    if (Mu_true is not None) & (Var_true is not None):
        for i in range(n_clusters):
            plot_args = {'fc': 'None', 'lw': 2, 'edgecolor': colors[i], 'alpha': 0.5}
            ellipse = Ellipse(Mu_true[i], 3 * Var_true[i][0], 3 * Var_true[i][1], **plot_args)
            ax.add_patch(ellipse)
    plt.show()

# Mæ­¥æ ¹æ®æ›´æ–°çš„Wå’ŒPIæ¥è·Ÿæ–°å‡å€¼Muä¸æ–¹å·®Var
# æ›´æ–°Mu
def update_Mu(X, W):
    n_clusters = W.shape[1]
    Mu = np.zeros((n_clusters, 2))
    for i in range(n_clusters):
        Mu[i] = np.average(X, axis=0, weights=W[:, i])
    return Mu


# æ›´æ–°Var
def update_Var(X, Mu, W):
    n_clusters = W.shape[1]
    Var = np.zeros((n_clusters, 2))
    for i in range(n_clusters):
        Var[i] = np.average((X - Mu[i]) ** 2, axis=0, weights=W[:, i])
    return Var


if __name__ == '__main__':
    # ç”Ÿæˆæ•°æ®
    true_Mu = [[0.5, 0.5], [5.5, 2.5], [1, 7]]
    true_Var = [[1, 3], [2, 2], [6, 2]]
    X = generate_X(true_Mu, true_Var)
    # åˆå§‹åŒ–
    n_clusters = 3 #èšç±»çš„ä¸ªæ•°
    n_points = len(X)
    Mu = [[0, -1], [6, 0], [0, 9]]
    Var = [[1, 1], [1, 1], [1, 1]]
    Pi = [1 / n_clusters] * 3
    W = np.ones((n_points, n_clusters)) / n_clusters #éšå˜é‡
    Pi = W.sum(axis=0) / W.sum() #æ¯ä¸€ç°‡çš„æ¯”é‡ï¼Œå¯ä»¥æ ¹æ®Wæ±‚å¾—
    # è¿­ä»£
    loglh = []
    for i in range(5):
        plot_clusters(X, Mu, Var, true_Mu, true_Var)
        loglh.append(logLH(X, Pi, Mu, Var))
        W = update_W(X, Mu, Var, Pi)
        Pi = update_Pi(W)
        Mu = update_Mu(X, W)
        print('log-likehood:%.3f'%loglh[-1])
        Var = update_Var(X, Mu, W)
```

## [å‚è€ƒæ–‡çŒ®](#content)

[1] åˆ˜å»ºå¹³ï¼š[æœ€å¤§ç†µæ¨¡å‹åŸç†å°ç»“](https://www.cnblogs.com/pinard/p/6093948.html)

[2] å¿†è‡»: [ä¸€æ–‡ææ‡‚æå¤§ä¼¼ç„¶ä¼°è®¡](https://zhuanlan.zhihu.com/p/26614750)

[3] çŸ¥è¡Œæµæµªï¼š[æå¤§ä¼¼ç„¶ä¼°è®¡è¯¦è§£](https://blog.csdn.net/zengxiantao1994/article/details/72787849)

[4] åˆ˜å»ºå¹³ï¼š[EMç®—æ³•åŸç†æ€»ç»“](https://www.cnblogs.com/pinard/p/6912636.html)

[5] v_JULY_vï¼š[å¦‚ä½•é€šä¿—ç†è§£EMç®—æ³•](https://blog.csdn.net/v_JULY_v/article/details/81708386)

[6] æ—ç«‹æ°‘çˆ±æ´—æ¾¡ï¼š[è¯¦è§£EMç®—æ³•ä¸æ··åˆé«˜æ–¯æ¨¡å‹(Gaussian mixture model, GMM)](https://blog.csdn.net/lin_limin/article/details/81048411)

